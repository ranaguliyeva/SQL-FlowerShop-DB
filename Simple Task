--DDL
drop table countries1;

create table countries1(
name varchar(20),
capital varchar(20),
citizens number);

alter table countries add constraint countries1_pk primary key(name);
alter table countries add constraint citizens_chck check(citizens between 500000 and 1000000);

--DML
insert into countries1 (name, capital, citizens) values ('Azerbaijan', 'Baku', 10000000);
commit;
insert into countries1 (name, capital, citizens) values ('Russia', 'Moscow', 140000000);
commit;
insert into countries1 (name, capital, citizens) values ('Lithuania', 'Vilnius', 3000000);
commit;
insert into countries1 (name, capital, citizens) values ('Turkey', 'Istanbul', 83000000);
commit;
insert into countries1 (name, capital, citizens) values ('Japan', 'Tokyo', 126000000);
commit;
insert into countries1(name, capital, citizens) values ('Azerbaijan', 'Baku', 11000000);
commit;

update countries1 set capital='Ankara' where name='Turkey';
delete from countries1 where name='Azerbaijan' and citizens=11000000;

--Select statement. Queries
select * from countries1;

select * from countries1
where name like '%ia';

select * from countries1
where citizens > 10000000
order by citizens desc;

select name, citizens
from countries1
order by citizens desc
fetch next 3 rows only;

select avg(citizens) as average_population
from countries1;

select capital from countries1
group by capital
having avg(citizens) < 10000000;

--SET operators
select employee_id, job_id from employees
where first_name LIKE '%a%'
union 
select employee_id, job_id from employees
where salary >=1000;

select employee_id, first_name from employees
where email like '%i%'
intersect
select employee_id, first_name from employees
order by first_name desc;

--Join
select e.first_name, e.last_name, j.job_title
from employees e
join jobs j on e.job_id=j.job_id;

select e.first_name as employee_name, m.first_name as manager_name
from employees e
join employees m on e.employee_id=m.manager_id; 

select employee_id, salary, email from employees
natural join departments;

